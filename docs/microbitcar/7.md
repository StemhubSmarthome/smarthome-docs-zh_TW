# 第七課
## 簡介 
<P>
歡迎參加Micro：bit 智能小車課程！在本課程中，我們將探索Micro：bit並學習如何在編程中如何控制Micro：bit智能小車。
<P>

## 教學目標
<P>
讓學生清楚掌握Micro：bit 智能小車的巡線行駛的原理及其功用，並了解如何透過設計編程令智能小車巡著黑線行駛及掉頭。
<P>

## 巡線行駛
<P>巡線模組位於車子的底部，並分為左右兩邊探測。
<P>

+ 紅外巡線傳感器       	  
+ 巡線基本模組

<P>
讀取P13和P14的數位信號即能尋找黑色線
<P>
<P>
把數位信號讀取的引腳儲存到變數R或L
<P>
<P>
巡線模組運作時指示燈會亮起，當其中一方探測到黑色，指示燈會熄滅，數位信號會由1轉為0(輸出只能是“1”或“0”）
<P>
<P>
**(黑=0，白=1)**
<P>
<P>
情況1:小車在黑色線上
<P>
<P>
小車會續向沿著黑色線行駛
<P>
<P>
情況2:小車向左偏離黑色線
<P>
<P>
小車在感應到偏離後會向右校正位置  
<P>
<P>
並重新沿著黑線行駛
<P>
<P>
情況3:小車向右偏離黑色線        
<P>
<P>
小車在感應到偏離後會向左校正位置並  
<P>
<P>
重新沿著黑線行駛
<P>
<P>
情況4:小車在黑線的盡頭感應不到黑色線
<P>
<P>
小車會倒後行駛直至尋找到黑色線
<P>

## 練習一:設計程序令小車巡著黑色線行駛
<P>
提示：根據page 4的4種例子，把程式分為4個部分
<P>
 
## 練習二:
<P>
設計程式令小車巡著黑色線行駛，並在黑線的盡頭掉頭
<P>
<P>
提示：留意掉頭的車速
<P>

## 練習三：
<P>
設計程式令小車循著黑色線行駛，及遇到前方的障礙物時掉頭
<P>
<P>
提示：利用超聲波預測障礙物位置，利用巡線傳感器令車子跟隨黑線走
<P>

## 練習四：迷宮**
<P>
車子必須繞開障礙物，並由起點出發到終點。
<P>
<P>
提示：超聲波+紅外循線模組會被使用(參考第六課練習七，第七課練習一)
<P>
<P>
討論：在避開障礙物的時候，哪一個路線會比較有效率？
<P>

## **挑戰**
<P>
在練習1中，我們需要分別檢查左邊及右邊感應器（L和R）的數位信號4次以達成巡線行駛。
<P>
<P>
嘗試再設計一個更加快捷、簡短、方便的程序達成類似效果，并且令車子在出界後不會後退，而是向最靠近黑線的方向轉彎重新返回線上。
<P>
<P>
提示：
<P>
  
+ 建立變數 ，想想如何在同時間儲存左右邊感應器的數位信號
+ 建立變數 儲存出界時的信號，並決定出界後的轉彎方向

## 答案
### 練習一：
<P>
1.	黃色框設定感應器的數位信號
<P>
<P>
2.	根據page4的4種例子，把程式分為4個部分
<P>
<P>
**注意車速不能太快，感應器需要時間感應路線**
<P>
 
### 練習二：
<P>
設計程序令小車巡著黑色線行駛，並在黑線的盡頭掉頭
<P>
<P>
基本上和練習1的做法一樣，只是要留意馬達在掉頭和倒退的分別
<P>
  
### 練習三：
<P>
設計程式令小車循著黑色線行駛，及遇到前方的障礙物時掉頭
<P>
<P>
提示：利用超聲波預測障礙物位置，利用巡線傳感器令車子跟隨黑線走
<P>
 
### 練習四：
<P>
車子必須繞開障礙物，並由起點出發到終點。
<P>
<P>
這個程式用了函式，函式的意義在於令程式更簡潔，因為可以不用一直重複。例如下面分別有兩個函式(sensor, ultrasound) ，在sensor內可以呼叫ultrasound的函式。
<P>
<P>
左圖第一個紅框示範了如果車子遇到障礙物的話，會呼叫ultrasound函式來避開障礙物，否則就會開始循著黑色線走。
<P>
<P>
sensor的功能和練習三一樣，也會循著黑色線走，當沒有偵測到黑線的時候，會旋轉180度，直到找到黑線為止
<P>
<P>
ultrasound的功能也和第六課的練習七一樣，會繞開障礙物。特別的是，第二個紅框避免了繞開後沒有繼續循線的情況。
<P>

### **挑戰**
<P>
透過以下程序，運行一次程序最多只需要檢查3次，比原來的8次少，因此更加快捷，簡短。
<P>
